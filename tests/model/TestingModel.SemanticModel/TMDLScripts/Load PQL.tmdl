createOrReplace
	/// DAX Assertion Library Functions
	/// Publisher: PQL (Power Query Lint)
	/// These functions provide a standardized way to write unit tests for DAX models
	/// Basic Assertions - PQL.Assert namespace
	function 'PQL.Assert.ShouldBeTrue' =
			(testName : STRING, actualCondition : BOOLEAN) =>
				VAR _Passed = actualCondition = TRUE
				RETURN ROW(
					"TestName", testName,
					"Expected", "TRUE",
					"Actual", IF(actualCondition, "TRUE", "FALSE"),
					"Passed", _Passed
				)

	function 'PQL.Assert.ShouldBeFalse' =
			(testName : STRING, actualCondition : BOOLEAN) =>
				VAR _Passed = actualCondition = FALSE
				RETURN ROW(
					"TestName", testName,
					"Expected", "FALSE",
					"Actual", IF(actualCondition, "TRUE", "FALSE"),
					"Passed", _Passed
				)

	function 'PQL.Assert.ShouldBeNull' =
			(testName : STRING, actualValue : VARIANT) =>
				VAR _Passed = ISBLANK(actualValue)
				RETURN ROW(
					"TestName", testName,
					"Expected", "NULL",
					"Actual", IF(ISBLANK(actualValue), "NULL", "NOT NULL"),
					"Passed", _Passed
				)

	/// Asserts that a value is not null/blank. Accepts both simple values and expressions.
	function 'PQL.Assert.ShouldNotBeNull' =
			(testName : STRING, actualValue : SCALAR VARIANT EXPR) =>
				VAR _ActualResult = actualValue
				VAR _Passed = NOT ISBLANK(_ActualResult)
				RETURN ROW(
					"TestName", testName,
					"Expected", "NOT NULL",
					"Actual", IF(ISBLANK(_ActualResult), "NULL", "NOT NULL"),
					"Passed", _Passed
				)

	function 'PQL.Assert.ShouldEqual' =
			(testName : STRING, expected : VARIANT, actual : VARIANT) =>
				VAR _Passed = expected = actual
				RETURN ROW(
					"TestName", testName,
					"Expected", FORMAT(expected, ""),
					"Actual", FORMAT(actual, ""),
					"Passed", _Passed
				)

	function 'PQL.Assert.ShouldNotEqual' =
			(testName : STRING, notExpected : VARIANT, actual : VARIANT) =>
				VAR _Passed = notExpected <> actual
				RETURN ROW(
					"TestName", testName,
					"Expected", "NOT " & FORMAT(notExpected, ""),
					"Actual", FORMAT(actual, ""),
					"Passed", _Passed
				)

	function 'PQL.Assert.ShouldBeGreaterThan' =
			(testName : STRING, threshold : DOUBLE, actual : DOUBLE) =>
				VAR _Passed = actual > threshold
				RETURN ROW(
					"TestName", testName,
					"Expected", "> " & FORMAT(threshold, ""),
					"Actual", FORMAT(actual, ""),
					"Passed", _Passed
				)

	function 'PQL.Assert.ShouldBeLessThan' =
			(testName : STRING, threshold : DOUBLE, actual : DOUBLE) =>
				VAR _Passed = actual < threshold
				RETURN ROW(
					"TestName", testName,
					"Expected", "< " & FORMAT(threshold, ""),
					"Actual", FORMAT(actual, ""),
					"Passed", _Passed
				)

	function 'PQL.Assert.ShouldBeBetween' =
			(testName : STRING, lowerBound : DOUBLE, upperBound : DOUBLE, actual : DOUBLE) =>
				VAR _Passed = actual >= lowerBound && actual <= upperBound
				RETURN ROW(
					"TestName", testName,
					"Expected", FORMAT(lowerBound, "") & " <= value <= " & FORMAT(upperBound, ""),
					"Actual", FORMAT(actual, ""),
					"Passed", _Passed
				)

	/// Col Assertions - PQL.Assert.Col namespace
	/// Asserts that a column contains at least one non-null value. Pass column reference directly.
	function 'PQL.Assert.Col.ShouldNotBeNull' =
			(testName : STRING, columnRef : ANYREF EXPR) =>
				VAR _NonBlankCount = DISTINCTCOUNTNOBLANK(columnRef)
				VAR _Passed = _NonBlankCount > 0
				RETURN ROW(
					"TestName", testName,
					"Expected", "Column has non-null values",
					"Actual", IF(_Passed, "HAS VALUES (" & FORMAT(_NonBlankCount, "0") & " distinct)", "ALL NULL/BLANK"),
					"Passed", _Passed
				)

	/// Asserts that all values in a column are unique (no duplicates).
	function 'PQL.Assert.Col.ShouldBeDistinct' =
			(testName : STRING, columnRef : ANYREF EXPR) =>
				VAR _DistinctCount = DISTINCTCOUNT(columnRef)
				VAR _TotalCount = COUNTROWS(VALUES(columnRef))
				VAR _Passed = _DistinctCount = _TotalCount
				RETURN ROW(
					"TestName", testName,
					"Expected", "All values distinct",
					"Actual", IF(_Passed, "ALL DISTINCT (" & FORMAT(_TotalCount, "0") & " rows)", "DUPLICATES FOUND (" & FORMAT(_DistinctCount, "0") & " distinct of " & FORMAT(_TotalCount, "0") & " rows)"),
					"Passed", _Passed
				)

	function 'PQL.Assert.Col.ShouldExist' =
			(testName : STRING, tableName : STRING, columnName : STRING) =>
				VAR _Columns = INFO.VIEW.COLUMNS()
				VAR _Found = COUNTROWS(FILTER(_Columns, [Table] = tableName && [Name] = columnName)) > 0
				RETURN ROW(
					"TestName", testName,
					"Expected", "Column '" & tableName & "[" & columnName & "]' exists",
					"Actual", IF(_Found, "EXISTS", "NOT FOUND"),
					"Passed", _Found
				)

	/// Table Assertions - PQL.Assert.Table namespace
	/// Asserts that a table has at least one row.
	function 'PQL.Assert.Tbl.ShouldHaveRows' =
			(testName : STRING, tableRef : TABLE EXPR) =>
				VAR _RowCount = COUNTROWS(tableRef)
				VAR _Passed = _RowCount > 0
				RETURN ROW(
					"TestName", testName,
					"Expected", "Table has rows",
					"Actual", IF(_Passed, "HAS ROWS (" & FORMAT(_RowCount, "0") & ")", "EMPTY (0 rows)"),
					"Passed", _Passed
				)

	/// Asserts that a table has exactly the expected number of rows.
	function 'PQL.Assert.Tbl.ShouldHaveRowCount' =
			(testName : STRING, tableRef : TABLE EXPR, expectedRowCount : INT64) =>
				VAR _RowCount = COUNTROWS(tableRef)
				VAR _Passed = _RowCount = expectedRowCount
				RETURN ROW(
					"TestName", testName,
					"Expected", FORMAT(expectedRowCount, "0") & " rows",
					"Actual", FORMAT(_RowCount, "0") & " rows",
					"Passed", _Passed
				)

	function 'PQL.Assert.Tbl.ShouldHaveMoreRowsThan' =
			(testName : STRING, threshold : INT64, tableToCheck : TABLE) =>
				VAR _RowCount = COUNTROWS(tableToCheck)
				VAR _Passed = _RowCount > threshold
				RETURN ROW(
					"TestName", testName,
					"Expected", "> " & FORMAT(threshold, "0"),
					"Actual", FORMAT(_RowCount, "0"),
					"Passed", _Passed
				)

	function 'PQL.Assert.Tbl.ShouldExist' =
			(testName : STRING, tableName : STRING) =>
				VAR _Tables = INFO.VIEW.TABLES()
				VAR _Found = COUNTROWS(FILTER(_Tables, [Name] = tableName)) > 0
				RETURN ROW(
					"TestName", testName,
					"Expected", "Table '" & tableName & "' exists",
					"Actual", IF(_Found, "EXISTS", "NOT FOUND"),
					"Passed", _Found
				)

	/// Relationship Assertions - PQL.Assert.Relationship namespace
	function 'PQL.Assert.Relationship.ShouldExist' =
			(testName : STRING, fromTable : STRING, fromColumn : STRING, toTable : STRING, toColumn : STRING) =>
				VAR _Relationships = INFO.VIEW.RELATIONSHIPS()
				VAR _Found = COUNTROWS(FILTER(_Relationships,
					[FromTable] = fromTable && [FromColumn] = fromColumn &&
					[ToTable] = toTable && [ToColumn] = toColumn)) > 0
				RETURN ROW(
					"TestName", testName,
					"Expected", "Relationship '" & fromTable & "[" & fromColumn & "] -> " & toTable & "[" & toColumn & "]' exists",
					"Actual", IF(_Found, "EXISTS", "NOT FOUND"),
					"Passed", _Found
				)

